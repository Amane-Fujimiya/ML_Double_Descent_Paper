\documentclass[preview, border=5pt,10pt]{standalone}
\usepackage[preprint]{jmlr2e}
\usepackage{blindtext}
\usepackage{subfig}
% Any additional packages needed should be included after jmlr2e.
% Note that jmlr2e.sty includes epsfig, amssymb, natbib and graphicx,
% and defines many common macros, such as 'proof' and 'example'.
%
% It also sets the bibliographystyle to plainnat; for more information on
% natbib citation styles, see the natbib documentation, a copy of which
% is archived at http://www.jmlr.org/format/natbib.pdf

% Available options for package jmlr2e are:
%
%   - abbrvbib : use abbrvnat for the bibliography style
%   - nohyperref : do not load the hyperref package
%   - preprint : remove JMLR specific information from the template,
%         useful for example for posting to preprint servers.
%
% Example of using the package with custom options:
%
% \usepackage[abbrvbib, preprint]{jmlr2e}

\usepackage[utf8]{inputenc} % allow utf-8 input
\usepackage[T1]{fontenc}    % use 8-bit T1 fonts
\usepackage{url}            % simple URL typesetting
\usepackage{booktabs}       % professional-quality tables
\usepackage{amsfonts}       % blackboard math symbols
\usepackage{nicefrac}       % compact symbols for 1/2, etc.
\usepackage{microtype}      % microtypography

\input{preamble.tex}
\usepackage[leftcaption]{sidecap}
\input{mathcommand.tex}



\usepackage{caption}
%\captionsetup{type=figure}

\graphicspath{{media/}} 
% Definitions of handy macros can go here

\newcommand{\dataset}{{\cal D}}
\newcommand{\fracpartial}[2]{\frac{\partial #1}{\partial  #2}}

% Heading arguments are {volume}{year}{pages}{date submitted}{date published}{paper id}{author-full-names}

\usepackage{lastpage}
%\jmlrheading{23}{2022}{1-\pageref{LastPage}}{1/21; Revised 5/22}{9/22}{21-0000}{Author One and Author Two}

% Short headings should be running head and authors last names

%\ShortHeadings{Sample JMLR Paper}{One and Two}
%\firstpageno{1}
\newcommand{\imsize}{0.22\textwidth}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% -- TIKZ DEFINITION -- %%
\pgfdeclarelayer{background}
\pgfdeclarelayer{foreground}
\pgfsetlayers{background,main,foreground}

% Define block styles used later

\tikzstyle{sensor}=[draw, fill=blue!20, text width=5em, 
    text centered, minimum height=2.5em,drop shadow]
\tikzstyle{ann} = [above, text width=5em, text centered]
\tikzstyle{wa} = [sensor, text width=10em, fill=red!20, 
    minimum height=6em, rounded corners, drop shadow]
\tikzstyle{sc} = [sensor, text width=13em, fill=red!20, 
    minimum height=10em, rounded corners, drop shadow]

% Define distances for bordering
\def\blockdist{2.3}
\def\edgedist{2.5}
\definecolor{bg}{gray}{0.95}

\usetikzlibrary{decorations.pathmorphing}
\usetikzlibrary{3d,perspective}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

% first row: images 1â€“4
%\begin{figure}
%\centering
%
%% first row
%%\subfloat[][$n=12$]{\includegraphics[width=\imsize]{img/%%descent_devel_t1.png}\label{fig:1a2}}\enspace
%%    \subfloat[][$n=24$]{\includegraphics[width=\imsize]{img/%%descent_devel_t2.png}\label{fig:1b2}}\enspace
%%    \subfloat[][$n=36$]{\includegraphics[width=\imsize]{img/%%descent_devel_t3.png}\label{fig:1c2}}\enspace
%%    \subfloat[][$n=50$]{\includegraphics[width=\imsize]{img/%%descent_devel_t4.png}\label{fig:1d2}} \\
%%
%%    % second row
%%    \subfloat[][$n=76$]{\includegraphics[width=\imsize]{img/%%descent_devel_t5.png}\label{fig:2a2}}\enspace
%%    \subfloat[][$n=82$]{\includegraphics[width=\imsize]{img/%%descent_devel_t6.png}\label{fig:2b2}}\enspace
%%    \subfloat[][$n=90$]{\includegraphics[width=\imsize]{img/%%descent_devel_t7.png}\label{fig:2c2}}\enspace
%%    \subfloat[][$n=100$]{\includegraphics[width=\imsize]{img/%%descent_devel_t8.png}\label{fig:2d2}} \\
%%
%%    % third row
%%    \subfloat[][$n=106$]{\includegraphics[width=\imsize]{img/%%descent_devel_t9.png}\label{fig:3a2}}\enspace
%%    \subfloat[][$n=112$]{\includegraphics[width=\imsize]{img/%%descent_devel_t10.png}\label{fig:3b2}}\enspace
%%    \subfloat[][$n=121$]{\includegraphics[width=\imsize]{img/%%descent_devel_t11.png}\label{fig:3c2}}
%
%% first row
%\subfloat[][$n=12$]{\includegraphics[width=\imsize]{img2/%risk_curve_n12.png}\label{fig:2a}}\enspace
%\subfloat[][$n=24$]{\includegraphics[width=\imsize]{img2/%risk_curve_n24.png}\label{fig:2b}}\enspace
%\subfloat[][$n=36$]{\includegraphics[width=\imsize]{img2/%risk_curve_n36.png}\label{fig:2c}}\enspace
%\subfloat[][$n=50$]{\includegraphics[width=\imsize]{img2/%risk_curve_n50.png}\label{fig:2d}} \\
%
%% second row
%\subfloat[][$n=76$]{\includegraphics[width=\imsize]{img2/%risk_curve_n76.png}\label{fig:2e}}\enspace
%\subfloat[][$n=82$]{\includegraphics[width=\imsize]{img2/%risk_curve_n82.png}\label{fig:2f}}\enspace
%\subfloat[][$n=90$]{\includegraphics[width=\imsize]{img2/%risk_curve_n90.png}\label{fig:2g}}\enspace
%\subfloat[][$n=100$]{\includegraphics[width=\imsize]{img2/%risk_curve_n100.png}\label{fig:2h}} \\
%
%% third row
%\subfloat[][$n=106$]{\includegraphics[width=\imsize]{img2/%risk_curve_n106.png}\label{fig:2i}}\enspace
%\subfloat[][$n=112$]{\includegraphics[width=\imsize]{img2/%risk_curve_n112.png}\label{fig:2j}}\enspace
%\subfloat[][$n=121$]{\includegraphics[width=\imsize]{img2/%risk_curve_n121.png}\label{fig:2k}}\enspace
%\subfloat[][$n=150$]{\includegraphics[width=\imsize]{img2/%risk_curve_n150.png}\label{fig:2l}} \\
%
%% fourth row
%\subfloat[][$n=231$]{\includegraphics[width=\imsize]{img2/%risk_curve_n231.png}\label{fig:2m}}\enspace
%\subfloat[][$n=250$]{\includegraphics[width=\imsize]{img2/%risk_curve_n250.png}\label{fig:2n}}\enspace
%\subfloat[][$n=256$]{\includegraphics[width=\imsize]{img2/%risk_curve_n256.png}\label{fig:2o}}\enspace
%\subfloat[][$n=280$]{\includegraphics[width=\imsize]{img2/%risk_curve_n280.png}\label{fig:2p}}
%
%
%
%\end{figure}

\begin{figure}[h!]
    \centering
    \begin{tikzpicture}[3d view={20}{15}]
        \foreach \Z in {0,...,4}
        {
            \begin{scope}[canvas is xy plane at z=-(\Z+ (0.5)*\Z),transform shape]
                \ifnum\Z>0 
                    \draw[semithick,gray,dashed] (0,0) coordinate(p\Z) rectangle (4,4);
                \fi 
                % Insert another TikZ picture dynamically for each layer
                \ifnum\Z=0 % Example: Add a specific illustration at layer 2
                \begin{scope}[scale=0.5]
                    \node (wa) [wa] at (5,1) {Core system};

                    \path (wa.west)+(-2.2,1.5) node (asr1) [sensor] {Sensor 1};
                    \path (wa.west)+(-2.2,0.5) node (asr2)[sensor] {Sensor 2};
                    \path (wa.west)+(-2.2,-1.0) node (dots)[ann] {$\vdots$}; 
                    \path (wa.west)+(-2.2,-2.0) node (asr3)[sensor] {Sensor $n$};    
                    \path (wa.south)+(0,-1.0) node (wo) [sensor] {Core components}; 
                   
                    \path (wa.east)+(\blockdist,0) node (vote) [sensor] {Actors $\mathcal{A}$};
                
                    \path [draw, ->] (wa.south) -- node [above] {} 
                        (wo.north) ;
                    
                    \path [draw, ->] (asr1.east) -- node [above] {} 
                        (wa.160) ;
                    \path [draw, ->] (asr2.east) -- node [above] {} 
                        (wa.180);
                    \path [draw, ->] (asr3.east) -- node [above] {} 
                        (wa.200);
                    \path [draw, ->] (wa.east) -- node [above] {} 
                        (vote.west);
                    \path (wa.south) +(0,-1.5) node (asrs) {};
                \end{scope}
                \fi
                \ifnum\Z=4
                \begin{scope}[scale=0.5]
                    \node (wa1) [sensor] at (4,4.2) {$M1$};
                    \path (wa1.west)+(-2.0,0) node (asr1) [sensor] {$M2$};
                    \path (wa1.east)+(2.0,0) node (asr2)[sensor] {$M3$};
                    \path (wa1.north)+(0,2.0) node (asr3)[sensor] {$M4$};   
                    \path (wa1.south)+(0,-2.0) node (asr4) [sensor] {$M5$}; 
                    \path [draw, ->] (wa1.west) -- node [above] {} 
                    (asr1.east) ;
                    \path [draw, ->] (wa1.east) -- node [above] {} 
                    (asr2.west) ;
                    \path [draw, ->] (wa1.north) -- node [above] {} 
                    (asr3.south) ;
                    \path [draw, ->] (wa1.south) -- node [above] {} 
                    (asr4.north) ;
            
                    \path [draw, ->] (asr1.north) -- node [above] {} 
                    (asr3.west) ;
                    \path [draw, ->] (asr3.east) -- node [above] {} 
                    (asr2.north) ;
                    \path [draw, ->] (asr2.south) -- node [above] {} 
                    (asr4.east) ;
                    \path [draw, ->] (asr4.west) -- node [above] {} 
                    (asr1.south) ;
                \end{scope}
                \fi
                \ifnum\Z=3
                \begin{scope}[scale=0.5]
                    \node (wa1) [sensor] at (4,4.2) {$M1$};
                    \path (wa1.west)+(-2.0,0) node (asr1) [sensor] {$M2$};
                    \path (wa1.east)+(2.0,0) node (asr2)[sensor] {$M3$};
                    \path (wa1.north)+(0,2.0) node (asr3)[sensor] {$M4$};   
                    \path (wa1.south)+(2.0,-2.0) node (asr4) [sensor] {$M5$}; 
                    \path (wa1.south)+(-2.0,-2.0) node (asr5) [sensor] {$M5$}; 
                    \path [draw, ->] (wa1.west) -- node [above] {} 
                    (asr1.east) ;
                    \path [draw, ->] (wa1.east) -- node [above] {} 
                    (asr2.west) ;
                    \path [draw, ->] (wa1.north) -- node [above] {} 
                    (asr3.south) ;
                    \path [draw, ->] (wa1.south) -- node [above] {} 
                    (asr4.north) ;
                    \path [draw, ->] (wa1.south) -- node [above] {} 
                    (asr5.north) ;
            
                    \path [draw, ->] (asr1.north) -- node [above] {} 
                    (asr3.west) ;
                    \path [draw, ->] (asr3.east) -- node [above] {} 
                    (asr2.north) ;
                    \path [draw, ->] (asr2.south) -- node [above] {} 
                    (asr4.east) ;
                    \path [draw, ->] (asr4.west) -- node [above] {} 
                    (asr5.east) ;
                    \path [draw, ->] (asr5.west) -- node [above] {} 
                    (asr1.south) ;
                \end{scope}
                \fi
                \ifnum\Z=2
                \begin{scope}[scale=0.5]
                    \node (wa1) [sensor] at (4,4.2) {$M1$};
                    \path (wa1.west)+(-2.0,2) node (asr1) [sensor] {$M2$};
                    \path (wa1.east)+(2.0,2) node (asr2)[sensor] {$M3$};
                    \path (wa1.south)+(0,-2.0) node (asr3)[sensor] {$M4$};   
            
                    \path [draw, ->] (wa1.west) -- node [above] {} 
                    (asr1.east) ;
                    \path [draw, ->] (wa1.east) -- node [above] {} 
                    (asr2.west) ;
                    \path [draw, ->] (wa1.south) -- node [above] {} 
                    (asr3.north) ;
            
            
                    \path [draw, ->] (asr1.south) -- node [above] {} 
                    (asr3.west) ;
                    \path [draw, ->] (asr3.east) -- node [above] {} 
                    (asr2.south) ;
                    \path [draw, ->] (asr2.west) -- node [above] {} 
                    (asr1.east) ;
                \end{scope}
                \fi
                \ifnum\Z=1
                \begin{scope}[scale=0.5]
                    \node (wa1) [sensor] at (4,4.2) {$M1$};
                    \path (wa1.west)+(-2.0,2) node (p2) [sensor] {$M2$};
                    \path (wa1.east)+(2.0,2) node (p3)[sensor] {$M3$};
                    \path (wa1.south)+(2,-2.0) node (p4)[sensor] {$M4$};  
                    \path (wa1.south)+(-2,-2.0) node (p5)[sensor] {$M5$};  
            
                    \path [draw, ->] (wa1.west) -- node [above] {} 
                    (p2.south) ;
                    \path [draw, ->] (wa1.east) -- node [above] {} 
                    (p3.south) ;
                    \path [draw, ->] (wa1.south) -- node [above] {} 
                    (p4.north) ;
                    \path [draw, ->] (wa1.south) -- node [above] {} 
                    (p5.north) ;
            
                    \path [draw, ->] (p2.east) -- node [above] {} 
                    (p3.west) ;
                    \path [draw, ->] (p3.south) -- node [above] {} 
                    (p4.north) ;
                    \path [draw, ->] (p4.west) -- node [above] {} 
                    (p5.east) ;
                    \path [draw, ->] (p5.north) -- node [above] {} 
                    (p2.south) ;
                \end{scope}
                \fi
            \end{scope}
            % Label for each layer
            \ifnum\Z>0
                \path (p\Z) node[left] {$\mathcal{L}_{\Z}([E_t])$};
            \fi
        }
    \end{tikzpicture}
\end{figure}


\end{document}
